(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{217:function(e,t,r){e.exports=r(410)},222:function(e,t,r){},224:function(e,t,r){},335:function(e,t){},337:function(e,t){},410:function(e,t,r){"use strict";r.r(t);var a=r(0),s=r.n(a),o=r(20),n=r.n(o),u=(r(222),r(44)),l=r(45),c=r(49),i=r(46),d=r(50),b=(r(224),r(70)),h=r.n(b),f=r(109),m=r(115),g=r(68),p=r(110),v=r(33),O=r.n(v),y=r(18),E=r(25),S=r(116),C=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(S.a)(Array(16)).reduce(function(t,r,a){return e&Math.pow(2,a)?[].concat(Object(S.a)(t),[Math.pow(2,a)]):t},[])}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);return Object.keys(e).reduce(function(r,a){return-1!==t.indexOf(e[a].value)?[].concat(Object(S.a)(r),[e[a].name]):r},[])},T={ROUTES:{id:0,shorthand:"routes",label:"routes"},BOULDERS:{id:1,shorthand:"boulders",label:"boulders"},MULTI_PITCH:{id:2,shorthand:"multi-pitch",label:"multi-pitch"}},w={1:{id:1,value:0,shorthand:"redpoint",name:"Redpoint",ascentTypes:[T.ROUTES.shorthand,T.BOULDERS.shorthand]},2:{id:2,value:53,shorthand:"flash",name:"Flash",ascentTypes:[T.ROUTES.shorthand,T.BOULDERS.shorthand]},3:{id:3,value:145,shorthand:"onsight",name:"Onsight",ascentTypes:[T.ROUTES.shorthand]},4:{id:4,value:-52,shorthand:"toprope",name:"Toprope",ascentTypes:[T.ROUTES.shorthand]},5:{id:5,value:95,shorthand:"onsight",name:"Onsight",ascentTypes:[T.BOULDERS.shorthand]}},V={NOTE_FA:{name:"First Ascent",value:1,score:{routes:30,boulders:20}},NOTE_2ND_GO:{name:"Second Go",value:2,score:{routes:2,boulders:2}},NOTE_TRAD:{name:"Traditional",value:4,score:{routes:30,boulders:0}},NOTE_SOFT:{name:"Soft",value:8,score:{routes:0,boulders:0}},NOTE_HARD:{name:"Hard",value:16,score:{routes:0,boulders:0}},NOTE_TRAV:{name:"Traverse",value:32,score:{routes:0,boulders:0}},NOTE_ONE_HANG:{name:"One Hang",value:64,score:{routes:-128,boulders:0}}},j=r(205),I=r(206),A=r.n(I),R=function(e){try{return JSON.parse(window.localStorage.getItem("raw-ascents-".concat(e)))}catch(t){}},x=function(e,t){try{return window.localStorage.setItem("raw-ascents-".concat(e),JSON.stringify(t))}catch(r){}},k=function(){var e=Object(f.a)(h.a.mark(function e(t){var r,a,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=R(t))){e.next=5;break}return e.next=4,B(r);case 4:return e.abrupt("return",e.sent);case 5:return a="https://cors-anywhere.herokuapp.com/https://www.8a.nu/scorecard/xml/".concat(t,"_routes.xml"),console.info("fetch",a),e.next=9,Object(j.a)(a);case 9:return s=e.sent,e.next=12,s.text();case 12:return r=e.sent,x(t,r),e.next=16,B(r);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),B=function(e){return new Promise(function(t,r){return new A.a.Parser({normalizeTags:!0,explicitArray:!1}).parseString(e,function(e,a){return e?r(e):(console.log("json",a),console.log("json.ascentlist.ascent",a&&a.ascentlist&&a.ascentlist.ascent),t(a.ascentlist.ascent))})})},D=k,U={0:{id:0,score:0,labels:{fra:{routes:"",boulder:""},usa:{routes:"",boulders:""}}},1:{id:1,score:0,labels:{fra:{routes:"",boulder:""},usa:{routes:"3/4",boulders:"VB"}}},2:{id:2,score:80,labels:{fra:{routes:"2",boulder:"2"},usa:{routes:"5.1",boulders:"VB"}}},3:{id:3,score:100,labels:{fra:{routes:"3a",boulder:"3A"},usa:{routes:"5.3",boulders:"VB"}}},4:{id:4,score:120,labels:{fra:{routes:"3b",boulder:"3B"},usa:{routes:"5.3",boulders:"VB"}}},5:{id:5,score:140,labels:{fra:{routes:"3c",boulder:"3C"},usa:{routes:"5.3",boulders:"V0-"}}},6:{id:6,score:160,labels:{fra:{routes:"4a",boulder:"4A"},usa:{routes:"5.4",boulders:"V0"}}},7:{id:7,score:180,labels:{fra:{routes:"4b",boulder:"4B"},usa:{routes:"5.5",boulders:"V0"}}},8:{id:8,score:200,labels:{fra:{routes:"4c",boulder:"4C"},usa:{routes:"5.6",boulders:"V0"}}},9:{id:9,score:250,labels:{fra:{routes:"5",boulder:"5"},usa:{routes:"",boulders:""}}},10:{id:10,score:250,labels:{fra:{routes:"5a",boulder:"5A"},usa:{routes:"5.7",boulders:"V1"}}},11:{id:11,score:300,labels:{fra:{routes:"5b",boulder:"5B"},usa:{routes:"5.8",boulders:"V1"}}},12:{id:12,score:350,labels:{fra:{routes:"5c",boulder:"5C"},usa:{routes:"5.9",boulders:"V2"}}},13:{id:13,score:400,labels:{fra:{routes:"6",boulder:"6"},usa:{routes:"",boulders:""}}},14:{id:14,score:400,labels:{fra:{routes:"6a",boulder:"6A"},usa:{routes:"5.10a",boulders:"V3"}}},15:{id:15,score:450,labels:{fra:{routes:"6a+",boulder:"6A+"},usa:{routes:"5.10b",boulders:"V3/4"}}},16:{id:16,score:500,labels:{fra:{routes:"6b",boulder:"6B"},usa:{routes:"5.10c",boulders:"V4"}}},17:{id:17,score:550,labels:{fra:{routes:"6b+",boulder:"6B+"},usa:{routes:"5.10d",boulders:"V4/V5"}}},18:{id:18,score:600,labels:{fra:{routes:"6c",boulder:"6C"},usa:{routes:"5.11a",boulders:"V5"}}},19:{id:19,score:650,labels:{fra:{routes:"6c+",boulder:"6C+"},usa:{routes:"5.11b",boulders:"V5/V6"}}},20:{id:20,score:700,labels:{fra:{routes:"7a",boulder:"7A"},usa:{routes:"5.11d",boulders:"V6"}}},21:{id:21,score:750,labels:{fra:{routes:"7a+",boulder:"7A+"},usa:{routes:"5.12a",boulders:"V7"}}},22:{id:22,score:800,labels:{fra:{routes:"7b",boulder:"7B"},usa:{routes:"5.12b",boulders:"V8"}}},23:{id:23,score:850,labels:{fra:{routes:"7b+",boulder:"7B+"},usa:{routes:"5.12c",boulders:"V8/9"}}},24:{id:24,score:900,labels:{fra:{routes:"7c",boulder:"7C"},usa:{routes:"5.12d",boulders:"V9"}}},25:{id:25,score:950,labels:{fra:{routes:"7c+",boulder:"7C+"},usa:{routes:"5.13a",boulders:"V10"}}},26:{id:26,score:1e3,labels:{fra:{routes:"8a",boulder:"8A"},usa:{routes:"5.13b",boulders:"V11"}}},27:{id:27,score:1050,labels:{fra:{routes:"8a+",boulder:"8A+"},usa:{routes:"5.13c",boulders:"V12"}}},28:{id:28,score:1100,labels:{fra:{routes:"8b",boulder:"8B"},usa:{routes:"5.13d",boulders:"V13"}}},29:{id:29,score:1150,labels:{fra:{routes:"8b+",boulder:"8B+"},usa:{routes:"5.14a",boulders:"V14"}}},30:{id:30,score:1200,labels:{fra:{routes:"8c",boulder:"8C"},usa:{routes:"5.14b",boulders:"V15"}}},31:{id:31,score:1225,labels:{fra:{routes:"8c/+",boulder:"8C/+"},usa:{routes:"5.14b/c",boulders:"V15/16"}}},32:{id:32,score:1250,labels:{fra:{routes:"8c+",boulder:"8C+"},usa:{routes:"5.14c",boulders:"V16"}}},33:{id:33,score:1275,labels:{fra:{routes:"8c+/9a",boulder:"8C+/9A"},usa:{routes:"5.14c/d",boulders:"V16/17"}}},34:{id:34,score:1300,labels:{fra:{routes:"9a",boulder:"9A"},usa:{routes:"5.14d",boulders:"V17"}}},35:{id:35,score:1325,labels:{fra:{routes:"9a/+",boulder:"9A/+"},usa:{routes:"5.14d/.15a",boulders:"V17/18"}}},36:{id:36,score:1350,labels:{fra:{routes:"9a+",boulder:"9A+"},usa:{routes:"5.15a",boulders:"V18"}}},37:{id:37,score:1375,labels:{fra:{routes:"9a+/9b",boulder:"9A+/9B"},usa:{routes:"5.15a/b",boulders:"V18/19"}}},38:{id:38,score:1400,labels:{fra:{routes:"9b",boulder:"9B"},usa:{routes:"5.15b",boulders:"V19"}}},39:{id:39,score:1425,labels:{fra:{routes:"9b/+",boulder:"9B/+"},usa:{routes:"5.15b/c",boulders:"V19/20"}}},40:{id:40,score:1450,labels:{fra:{routes:"9b+",boulder:"9B+"},usa:{routes:"5.15c",boulders:"V20"}}},41:{id:41,score:1475,labels:{fra:{routes:"9b+/9c",boulder:"9B+/9C"},usa:{routes:"",boulders:""}}},42:{id:42,score:1500,labels:{fra:{routes:"9c",boulder:"9C"},usa:{routes:"",boulders:""}}},43:{id:43,score:1525,labels:{fra:{routes:"9c/+",boulder:"9C/+"},usa:{routes:"",boulders:""}}},44:{id:44,score:1550,labels:{fra:{routes:"9c+",boulder:"9C+"},usa:{routes:"",boulders:""}}},45:{id:45,score:1575,labels:{fra:{routes:"9c+/10a",boulder:"9C+/10A"},usa:{routes:"",boulders:""}}}},L={"-":0,2:5,"3a":6,"3b":7,"3c":8,"4a":9,"4b":10,"4c":11,"5a":12,"5b":13,"5c":14,"6a":15,"6a+":16,"6b":17,"6b+":18,"6c":19,"6c+":20,"7a":21,"7a+":22,"7b":23,"7b+":24,"7c":25,"7c+":26,"8a":27,"8a+":28,"8b":29,"8b+":30,"8c":31,"8c+":32,"9a":33,"9a+":34,"9b":35,"9b+":36,"9c":37,"8c/+":38,"8c+/9a":39,"9a/+":40,"9a+/9b":41},N=Object.values(U).reduce(function(e,t){var r=L[t.labels.fra.routes];return"undefined"!==typeof r?Object(p.a)({},e,Object(g.a)({},r,t.id)):e},{});if(N.count!==L.count)throw new Error("count are not equal");var _=function(e){return e.filter(function(e){return"false"===e.dbascent}).sort(function(e,t){return e.date<t.date?-1:e.date>t.date?1:0}).map(function(e){e.notes=C(V,e.note),e.method=w[e.style],e.type=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return[T.ROUTES,T.BOULDERS,T.MULTI_PITCH][e]}(e.type),"CLS_UserAscent_Try"===e.objectclass&&(e.isTry=!0);var t=N[e.grade];return t||console.error("gradeId not found",e.grade),e.grade=U[t],e})},M={redpoint:"#f03c3c",flash:"#ffca10",onsight:"#333",toprope:"#666",attempt:"#fff"},Y=function(e){function t(e){var r;Object(u.a)(this,t),(r=Object(c.a)(this,Object(i.a)(t).call(this,e))).handleTimeRangeChange=function(e){e?r.setState({timerange:e,brushrange:e}):r.setState({timerange:r.state.startRange,brushrange:r.state.startRange})},r.handleSelectionChanged=function(e){return r.setState({selection:e})},r.handleMouseNear=function(e){return r.setState({highlight:e})},r.getGradeLabel=function(e){var t=U[e];return t?t.labels.fra.routes:(console.error("unknown grade!",e),"")};var a=e.ascents,s=a.map(function(e){return[new O.a(e.date).toDate().getTime(),e]}),o=(Object.entries(a.reduce(function(e,t){var r=new O.a(t.date).format("YYYY-MM-DD");return Object(p.a)({},e,Object(g.a)({},r,e[r]?e[r]+1:1))},{})).map(function(e){var t=Object(m.a)(e,2),r=t[0],a=t[1];return[new O.a(r).toDate().getTime(),a]}).sort(function(e,t){var r=Object(m.a)(e,1)[0],a=Object(m.a)(t,1)[0];return r<a?-1:r>a?1:0}),new y.TimeSeries({name:"Ascents",columns:["time","ascent"],points:s})),n=o.fixedWindowRollup({windowSize:"3d",aggregation:{count:{ascent:Object(y.count)()}}});console.log("series",o.toJSON()),console.log("dailySeries",n.toJSON());var l=O()(o.range().begin()),d=O()(o.range().end()),b=d.diff(l,"days");l=l.subtract(.025*b,"days").toDate(),d=d.add(.025*b,"days").toDate();var h=new y.TimeRange([l.getTime(),d.getTime()]);return r.state={series:o,dailySeries:n,startRange:h,timerange:h,brushrange:h,begin:l,end:d,hover:null,highlight:null,selection:null},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,r=t.startRange,a=t.series,o=(t.dailySeries,t.begin),n=t.end,u=t.highlight,l=[];if(u){var c=u.event.get("ascent");l=[{label:"".concat(c.cragname," - ").concat(c.name),value:"".concat(c.grade.labels.fra.routes," ").concat(c.isTry?"attempt":c.method.shorthand)}]}var i={values:{valueColor:"Green",valueWeight:200,valueSize:12}},d={fill:"black",stroke:"#00000036",opacity:.8};return d={normal:d,highlighted:d,selected:d,muted:d},s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(E.Resizable,null,s.a.createElement(E.ChartContainer,{timeRange:this.state.timerange,timeAxisStyle:i,maxTime:n,minTime:o,enablePanZoom:!0,onTimeRangeChanged:this.handleTimeRangeChange},s.a.createElement(E.ChartRow,{height:"400",debug:!1},s.a.createElement(E.YAxis,{id:"gradesY",min:a.min("ascent.grade.id")-2,max:a.max("ascent.grade.id")+2,style:{axis:{axisColor:"#C0C0C0"},label:{display:"none"},values:{valueSize:12}},width:"0",format:this.getGradeLabel}),s.a.createElement(E.Charts,null,s.a.createElement(E.ScatterChart,{axis:"gradesY",series:a,columns:["ascent.grade.id"],style:function(e,t){var r=t.get("ascent"),a=M[r.isTry?"attempt":r.method.shorthand];return{normal:{fill:a,stroke:"#00000036",opacity:.8},highlighted:{fill:a,stroke:"#00000036",strokeWidth:5,opacity:.8},selected:{fill:a,stroke:"#00000036",strokeWidth:3,opacity:1},muted:{fill:a,stroke:"none",opacity:.4}}},info:l,infoTimeFormat:function(e){return e.toLocaleDateString()},infoHeight:28,infoWidth:400,infoStyle:{fill:"black",color:"#DDD"},ScatterChart:!0,selected:this.state.selection,onMouseNear:function(t){return e.handleMouseNear(t)},highlight:this.state.highlight,radius:8})))))),s.a.createElement("div",null,s.a.createElement("div",{style:{paddingTop:10}},s.a.createElement(E.Resizable,null,s.a.createElement(E.ChartContainer,{timeRange:r,timeAxisStyle:i,hideTimeAxis:!1},s.a.createElement(E.ChartRow,{height:"50",debug:!1},s.a.createElement(E.Brush,{timeRange:this.state.brushrange,onTimeRangeChanged:this.handleTimeRangeChange}),s.a.createElement(E.YAxis,{id:"brushY",max:a.max("ascent.grade.id"),min:a.min("ascent.grade.id"),visible:!1,style:{}}),s.a.createElement(E.Charts,null,s.a.createElement(E.ScatterChart,{axis:"brushY",series:a,columns:["ascent.grade.id"],style:function(){return d},info:l,infoHeight:28,infoWidth:110,infoStyle:{fill:"black",color:"#DDD"},format:".1f"})))))))))}}]),t}(s.a.Component),H=r(23),W=r(415),z=r(416),G=r(411),J=r(207),P=r.n(J).a.parse(window.location.search),F=function(e){function t(){var e,r;Object(u.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(r=Object(c.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={userId:P&&P.userId&&/^[0-9]*$/.test(P.userId)?P.userId:""},r.checkUserId=function(e){return/^[0-9]*$/.test(e)},r.handleSubmit=function(e){e&&e.preventDefault(),r.checkUserId(r.userIdInput.state.value)&&r.props.onSubmit(r.userIdInput.state.value)},r.onClearUserId=function(){r.userIdInput.focus(),r.setState({userId:""})},r.onChangeUserId=function(e){var t=e.target.value;r.checkUserId(t)&&r.setState({userId:t})},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleSubmit()}},{key:"render",value:function(){var e=this,t=this.state.userId,r=t?s.a.createElement(H.a,{type:"close-circle",onClick:this.onClearUserId}):null;return s.a.createElement(W.a,{layout:"inline",onSubmit:this.handleSubmit},s.a.createElement(W.a.Item,null,s.a.createElement(z.a,{placeholder:"Enter your userId",prefix:s.a.createElement(H.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),suffix:r,value:t,onChange:this.onChangeUserId,ref:function(t){return e.userIdInput=t}})),s.a.createElement(W.a.Item,null,s.a.createElement(G.a,{type:"primary",htmlType:"submit",disabled:!t},"Load ascents!")))}}]),t}(s.a.Component),$=function(e){function t(){var e,r;Object(u.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(r=Object(c.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={userId:void 0,ascents:[],isLoading:!1,error:!1},r.onSubmitUserIdInput=function(){var e=Object(f.a)(h.a.mark(function e(t){var a,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.setState({isLoading:!0}),e.next=4,D(t);case 4:a=e.sent,s=_(a),console.log("ascents",s),r.setState({userId:t,ascents:s,isLoading:!1}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error",e.t0),r.setState({error:e.t0.message,isLoading:!1});case 14:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isLoading,r=e.error,a=e.ascents;return console.log("render",this.state),s.a.createElement("div",{className:"App"},s.a.createElement(F,{onSubmit:this.onSubmitUserIdInput}),t&&s.a.createElement("div",null,"Loading..."),r&&s.a.createElement("div",null,"Error: ",r),!t&&a.length>0&&s.a.createElement(Y,{ascents:a}))}}]),t}(s.a.PureComponent),q=function(e){function t(){return Object(u.a)(this,t),Object(c.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement($,null)}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(s.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[217,2,1]]]);
//# sourceMappingURL=main.9495ede4.chunk.js.map